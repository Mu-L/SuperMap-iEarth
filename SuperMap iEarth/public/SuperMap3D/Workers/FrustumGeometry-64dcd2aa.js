define(["exports","./buildModuleUrl-91a0d359","./Cartographic-9ee1f1bd","./Cartesian4-6d2e270a","./Check-737bd4ec","./ComponentDatatype-c2578c27","./when-7d8885d2","./GeometryAttribute-84124076","./GeometryAttributes-2f749385","./Matrix4-52faaaf8","./Math-4ffce144","./Intersect-3d22ecf4","./Plane-b5076158","./PrimitiveType-3a37fdd9","./VertexFormat-86386b6b"],(function(t,e,a,i,r,n,o,s,f,u,l,h,p,c,d){"use strict";function m(t){this.planes=o.defaultValue(t,[])}var C=[new a.Cartesian3,new a.Cartesian3,new a.Cartesian3];a.Cartesian3.clone(a.Cartesian3.UNIT_X,C[0]),a.Cartesian3.clone(a.Cartesian3.UNIT_Y,C[1]),a.Cartesian3.clone(a.Cartesian3.UNIT_Z,C[2]);var _=new a.Cartesian3,y=new a.Cartesian3,v=new p.Plane(new a.Cartesian3(1,0,0),0);function w(t){t=o.defaultValue(t,o.defaultValue.EMPTY_OBJECT),this.left=t.left,this._left=void 0,this.right=t.right,this._right=void 0,this.top=t.top,this._top=void 0,this.bottom=t.bottom,this._bottom=void 0,this.near=o.defaultValue(t.near,1),this._near=this.near,this.far=o.defaultValue(t.far,5e8),this._far=this.far,this._cullingVolume=new m,this._orthographicMatrix=new u.Matrix4}function g(t){t.top===t._top&&t.bottom===t._bottom&&t.left===t._left&&t.right===t._right&&t.near===t._near&&t.far===t._far||(t._left=t.left,t._right=t.right,t._top=t.top,t._bottom=t.bottom,t._near=t.near,t._far=t.far,t._orthographicMatrix=u.Matrix4.computeOrthographicOffCenter(t.left,t.right,t.bottom,t.top,t.near,t.far,t._orthographicMatrix))}m.fromBoundingSphere=function(t,e){o.defined(e)||(e=new m);var r=C.length,n=e.planes;n.length=2*r;for(var s=t.center,f=t.radius,u=0,l=0;l<r;++l){var h=C[l],p=n[u],c=n[u+1];o.defined(p)||(p=n[u]=new i.Cartesian4),o.defined(c)||(c=n[u+1]=new i.Cartesian4),a.Cartesian3.multiplyByScalar(h,-f,_),a.Cartesian3.add(s,_,_),p.x=h.x,p.y=h.y,p.z=h.z,p.w=-a.Cartesian3.dot(h,_),a.Cartesian3.multiplyByScalar(h,f,_),a.Cartesian3.add(s,_,_),c.x=-h.x,c.y=-h.y,c.z=-h.z,c.w=-a.Cartesian3.dot(a.Cartesian3.negate(h,y),_),u+=2}return e},m.prototype.computeVisibility=function(t){for(var e=this.planes,a=!1,i=0,r=e.length;i<r;++i){var n=t.intersectPlane(p.Plane.fromCartesian4(e[i],v));if(n===h.Intersect.OUTSIDE)return h.Intersect.OUTSIDE;n===h.Intersect.INTERSECTING&&(a=!0)}return a?h.Intersect.INTERSECTING:h.Intersect.INSIDE},m.prototype.computeVisibilityWithPlaneMask=function(t,e){if(e===m.MASK_OUTSIDE||e===m.MASK_INSIDE)return e;for(var a=m.MASK_INSIDE,i=this.planes,r=0,n=i.length;r<n;++r){var o=r<31?1<<r:0;if(!(r<31&&0==(e&o))){var s=t.intersectPlane(p.Plane.fromCartesian4(i[r],v));if(s===h.Intersect.OUTSIDE)return m.MASK_OUTSIDE;s===h.Intersect.INTERSECTING&&(a|=o)}}return a},m.MASK_OUTSIDE=4294967295,m.MASK_INSIDE=0,m.MASK_INDETERMINATE=2147483647,Object.defineProperties(w.prototype,{projectionMatrix:{get:function(){return g(this),this._orthographicMatrix}}});var x=new a.Cartesian3,M=new a.Cartesian3,b=new a.Cartesian3,V=new a.Cartesian3;function F(t){t=o.defaultValue(t,o.defaultValue.EMPTY_OBJECT),this._offCenterFrustum=new w,this.width=t.width,this._width=void 0,this.aspectRatio=t.aspectRatio,this._aspectRatio=void 0,this.near=o.defaultValue(t.near,1),this._near=this.near,this.far=o.defaultValue(t.far,5e8),this._far=this.far}function P(t){var e=t._offCenterFrustum;if(t.width!==t._width||t.aspectRatio!==t._aspectRatio||t.near!==t._near||t.far!==t._far){t._aspectRatio=t.aspectRatio,t._width=t.width,t._near=t.near,t._far=t.far;var a=1/t.aspectRatio;e.right=.5*t.width,e.left=-e.right,e.top=a*e.right,e.bottom=-e.top,e.near=t.near,e.far=t.far}}function E(t){t=o.defaultValue(t,o.defaultValue.EMPTY_OBJECT),this.left=t.left,this._left=void 0,this.right=t.right,this._right=void 0,this.top=t.top,this._top=void 0,this.bottom=t.bottom,this._bottom=void 0,this.near=o.defaultValue(t.near,1),this._near=this.near,this.far=o.defaultValue(t.far,5e8),this._far=this.far,this._cullingVolume=new m,this._perspectiveMatrix=new u.Matrix4,this._infinitePerspective=new u.Matrix4}function O(t){var e=t.top,a=t.bottom,i=t.right,r=t.left,n=t.near,o=t.far;e===t._top&&a===t._bottom&&r===t._left&&i===t._right&&n===t._near&&o===t._far||(t._left=r,t._right=i,t._top=e,t._bottom=a,t._near=n,t._far=o,t._perspectiveMatrix=u.Matrix4.computePerspectiveOffCenter(r,i,a,e,n,o,t._perspectiveMatrix),t._infinitePerspective=u.Matrix4.computeInfinitePerspectiveOffCenter(r,i,a,e,n,t._infinitePerspective))}w.prototype.computeCullingVolume=function(t,e,r){var n=this._cullingVolume.planes,s=this.top,f=this.bottom,u=this.right,l=this.left,h=this.near,p=this.far,c=a.Cartesian3.cross(e,r,x);a.Cartesian3.normalize(c,c);var d=M;a.Cartesian3.multiplyByScalar(e,h,d),a.Cartesian3.add(t,d,d);var m=b;a.Cartesian3.multiplyByScalar(c,l,m),a.Cartesian3.add(d,m,m);var C=n[0];return o.defined(C)||(C=n[0]=new i.Cartesian4),C.x=c.x,C.y=c.y,C.z=c.z,C.w=-a.Cartesian3.dot(c,m),a.Cartesian3.multiplyByScalar(c,u,m),a.Cartesian3.add(d,m,m),C=n[1],o.defined(C)||(C=n[1]=new i.Cartesian4),C.x=-c.x,C.y=-c.y,C.z=-c.z,C.w=-a.Cartesian3.dot(a.Cartesian3.negate(c,V),m),a.Cartesian3.multiplyByScalar(r,f,m),a.Cartesian3.add(d,m,m),C=n[2],o.defined(C)||(C=n[2]=new i.Cartesian4),C.x=r.x,C.y=r.y,C.z=r.z,C.w=-a.Cartesian3.dot(r,m),a.Cartesian3.multiplyByScalar(r,s,m),a.Cartesian3.add(d,m,m),C=n[3],o.defined(C)||(C=n[3]=new i.Cartesian4),C.x=-r.x,C.y=-r.y,C.z=-r.z,C.w=-a.Cartesian3.dot(a.Cartesian3.negate(r,V),m),C=n[4],o.defined(C)||(C=n[4]=new i.Cartesian4),C.x=e.x,C.y=e.y,C.z=e.z,C.w=-a.Cartesian3.dot(e,d),a.Cartesian3.multiplyByScalar(e,p,m),a.Cartesian3.add(t,m,m),C=n[5],o.defined(C)||(C=n[5]=new i.Cartesian4),C.x=-e.x,C.y=-e.y,C.z=-e.z,C.w=-a.Cartesian3.dot(a.Cartesian3.negate(e,V),m),this._cullingVolume},w.prototype.getPixelDimensions=function(t,e,a,i,r){g(this);var n=i*(this.right-this.left)/t,o=i*(this.top-this.bottom)/e;return r.x=n,r.y=o,r},w.prototype.clone=function(t){return o.defined(t)||(t=new w),t.left=this.left,t.right=this.right,t.top=this.top,t.bottom=this.bottom,t.near=this.near,t.far=this.far,t._left=void 0,t._right=void 0,t._top=void 0,t._bottom=void 0,t._near=void 0,t._far=void 0,t},w.prototype.equals=function(t){return o.defined(t)&&t instanceof w&&this.right===t.right&&this.left===t.left&&this.top===t.top&&this.bottom===t.bottom&&this.near===t.near&&this.far===t.far},w.prototype.equalsEpsilon=function(t,e,a){return t===this||o.defined(t)&&t instanceof w&&l.CesiumMath.equalsEpsilon(this.right,t.right,e,a)&&l.CesiumMath.equalsEpsilon(this.left,t.left,e,a)&&l.CesiumMath.equalsEpsilon(this.top,t.top,e,a)&&l.CesiumMath.equalsEpsilon(this.bottom,t.bottom,e,a)&&l.CesiumMath.equalsEpsilon(this.near,t.near,e,a)&&l.CesiumMath.equalsEpsilon(this.far,t.far,e,a)},F.packedLength=4,F.pack=function(t,e,a){return a=o.defaultValue(a,0),e[a++]=t.width,e[a++]=t.aspectRatio,e[a++]=t.near,e[a]=t.far,e},F.unpack=function(t,e,a){return e=o.defaultValue(e,0),o.defined(a)||(a=new F),a.width=t[e++],a.aspectRatio=t[e++],a.near=t[e++],a.far=t[e],a},Object.defineProperties(F.prototype,{projectionMatrix:{get:function(){return P(this),this._offCenterFrustum.projectionMatrix}}}),F.prototype.computeCullingVolume=function(t,e,a){return P(this),this._offCenterFrustum.computeCullingVolume(t,e,a)},F.prototype.getPixelDimensions=function(t,e,a,i,r){return P(this),this._offCenterFrustum.getPixelDimensions(t,e,a,i,r)},F.prototype.clone=function(t){return o.defined(t)||(t=new F),t.aspectRatio=this.aspectRatio,t.width=this.width,t.near=this.near,t.far=this.far,t._aspectRatio=void 0,t._width=void 0,t._near=void 0,t._far=void 0,this._offCenterFrustum.clone(t._offCenterFrustum),t},F.prototype.equals=function(t){return!!(o.defined(t)&&t instanceof F)&&(P(this),P(t),this.width===t.width&&this.aspectRatio===t.aspectRatio&&this._offCenterFrustum.equals(t._offCenterFrustum))},F.prototype.equalsEpsilon=function(t,e,a){return!!(o.defined(t)&&t instanceof F)&&(P(this),P(t),l.CesiumMath.equalsEpsilon(this.width,t.width,e,a)&&l.CesiumMath.equalsEpsilon(this.aspectRatio,t.aspectRatio,e,a)&&this._offCenterFrustum.equalsEpsilon(t._offCenterFrustum,e,a))},Object.defineProperties(E.prototype,{projectionMatrix:{get:function(){return O(this),this._perspectiveMatrix}},infiniteProjectionMatrix:{get:function(){return O(this),this._infinitePerspective}}});var z=new a.Cartesian3,R=new a.Cartesian3,S=new a.Cartesian3,T=new a.Cartesian3;function k(t){t=o.defaultValue(t,o.defaultValue.EMPTY_OBJECT),this._offCenterFrustum=new E,this.fov=t.fov,this._fov=void 0,this._fovy=void 0,this._sseDenominator=void 0,this.aspectRatio=t.aspectRatio,this._aspectRatio=void 0,this.near=o.defaultValue(t.near,1),this._near=this.near,this.far=o.defaultValue(t.far,5e8),this._far=this.far,this.xOffset=o.defaultValue(t.xOffset,0),this._xOffset=this.xOffset,this.yOffset=o.defaultValue(t.yOffset,0),this._yOffset=this.yOffset,this.reflect=!1}function I(t){var e=t._offCenterFrustum;t.fov===t._fov&&t.aspectRatio===t._aspectRatio&&t.near===t._near&&t.far===t._far&&t.xOffset===t._xOffset&&t.yOffset===t._yOffset||(t._aspectRatio=t.aspectRatio,t._fov=t.fov,t._fovy=t.aspectRatio<=1?t.fov:2*Math.atan(Math.tan(.5*t.fov)/t.aspectRatio),t._near=t.near,t._far=t.far,t._sseDenominator=2*Math.tan(.5*t._fovy),t._xOffset=t.xOffset,t._yOffset=t.yOffset,e.top=t.near*Math.tan(.5*t._fovy),e.bottom=-e.top,e.right=t.aspectRatio*e.top,e.left=-e.right,e.near=t.near,e.far=t.far,e.right+=t.xOffset,e.left+=t.xOffset,e.top+=t.yOffset,e.bottom+=t.yOffset)}E.prototype.resetProjectionMatrix=function(){var t=this.top,e=this.bottom,a=this.right,i=this.left,r=this.near,n=this.far;this._left=i,this._right=a,this._top=t,this._bottom=e,this._near=r,this._far=n,this._perspectiveMatrix=u.Matrix4.computePerspectiveOffCenter(i,a,e,t,r,n,this._perspectiveMatrix),this._infinitePerspective=u.Matrix4.computeInfinitePerspectiveOffCenter(i,a,e,t,r,this._infinitePerspective)},E.prototype.computeCullingVolume=function(t,e,r,n){var s=this._cullingVolume.planes,f=o.defaultValue(n,0);f=Math.min(f,.5),f=Math.max(f,0);var u=this.top+this.top*f,l=this.bottom-this.top*f,h=this.right+this.right*f,p=this.left-this.right*f,c=this.near,d=this.far,m=a.Cartesian3.cross(e,r,z),C=R;a.Cartesian3.multiplyByScalar(e,c,C),a.Cartesian3.add(t,C,C);var _=S;a.Cartesian3.multiplyByScalar(e,d,_),a.Cartesian3.add(t,_,_);var y=T;a.Cartesian3.multiplyByScalar(m,p,y),a.Cartesian3.add(C,y,y),a.Cartesian3.subtract(y,t,y),a.Cartesian3.normalize(y,y),a.Cartesian3.cross(y,r,y),a.Cartesian3.normalize(y,y);var v=s[0];return o.defined(v)||(v=s[0]=new i.Cartesian4),v.x=y.x,v.y=y.y,v.z=y.z,v.w=-a.Cartesian3.dot(y,t),a.Cartesian3.multiplyByScalar(m,h,y),a.Cartesian3.add(C,y,y),a.Cartesian3.subtract(y,t,y),a.Cartesian3.cross(r,y,y),a.Cartesian3.normalize(y,y),v=s[1],o.defined(v)||(v=s[1]=new i.Cartesian4),v.x=y.x,v.y=y.y,v.z=y.z,v.w=-a.Cartesian3.dot(y,t),a.Cartesian3.multiplyByScalar(r,l,y),a.Cartesian3.add(C,y,y),a.Cartesian3.subtract(y,t,y),a.Cartesian3.cross(m,y,y),a.Cartesian3.normalize(y,y),v=s[2],o.defined(v)||(v=s[2]=new i.Cartesian4),v.x=y.x,v.y=y.y,v.z=y.z,v.w=-a.Cartesian3.dot(y,t),a.Cartesian3.multiplyByScalar(r,u,y),a.Cartesian3.add(C,y,y),a.Cartesian3.subtract(y,t,y),a.Cartesian3.cross(y,m,y),a.Cartesian3.normalize(y,y),v=s[3],o.defined(v)||(v=s[3]=new i.Cartesian4),v.x=y.x,v.y=y.y,v.z=y.z,v.w=-a.Cartesian3.dot(y,t),v=s[4],o.defined(v)||(v=s[4]=new i.Cartesian4),v.x=e.x,v.y=e.y,v.z=e.z,v.w=-a.Cartesian3.dot(e,C),a.Cartesian3.negate(e,y),v=s[5],o.defined(v)||(v=s[5]=new i.Cartesian4),v.x=y.x,v.y=y.y,v.z=y.z,v.w=-a.Cartesian3.dot(y,_),this._cullingVolume},E.prototype.getPixelDimensions=function(t,e,a,i,r){O(this);var n=1/this.near,o=this.top*n,s=2*i*a*o/e,f=2*i*a*(o=this.right*n)/t;return r.x=f,r.y=s,r},E.prototype.clone=function(t){return o.defined(t)||(t=new E),t.right=this.right,t.left=this.left,t.top=this.top,t.bottom=this.bottom,t.near=this.near,t.far=this.far,t._left=void 0,t._right=void 0,t._top=void 0,t._bottom=void 0,t._near=void 0,t._far=void 0,t},E.prototype.equals=function(t){return o.defined(t)&&t instanceof E&&this.right===t.right&&this.left===t.left&&this.top===t.top&&this.bottom===t.bottom&&this.near===t.near&&this.far===t.far},E.prototype.equalsEpsilon=function(t,e,a){return t===this||o.defined(t)&&t instanceof E&&l.CesiumMath.equalsEpsilon(this.right,t.right,e,a)&&l.CesiumMath.equalsEpsilon(this.left,t.left,e,a)&&l.CesiumMath.equalsEpsilon(this.top,t.top,e,a)&&l.CesiumMath.equalsEpsilon(this.bottom,t.bottom,e,a)&&l.CesiumMath.equalsEpsilon(this.near,t.near,e,a)&&l.CesiumMath.equalsEpsilon(this.far,t.far,e,a)},k.isNDCHalfZRange=!1,k.packedLength=6,k.pack=function(t,e,a){return a=o.defaultValue(a,0),e[a++]=t.fov,e[a++]=t.aspectRatio,e[a++]=t.near,e[a++]=t.far,e[a++]=t.xOffset,e[a]=t.yOffset,e},k.unpack=function(t,e,a){return e=o.defaultValue(e,0),o.defined(a)||(a=new k),a.fov=t[e++],a.aspectRatio=t[e++],a.near=t[e++],a.far=t[e++],a.xOffset=t[e++],a.yOffset=t[e],a},Object.defineProperties(k.prototype,{projectionMatrix:{get:function(){return I(this),this.reflect&&function(t){if(!o.defined(t.clipPlane)||!o.defined(t.currentViewMatrix)||k.isNDCHalfZRange)return;var e=t.currentViewMatrix,a=t._offCenterFrustum.projectionMatrix;u.Matrix4.multiplyByPlane(e,t.clipPlane,A),D.x=(l.CesiumMath.sign(A.normal.x)+a[8])/a[0],D.y=(l.CesiumMath.sign(A.normal.y)+a[9])/a[5],D.z=-1,D.w=(1+a[10])/a[14],q.x=A.normal.x,q.y=A.normal.y,q.z=A.normal.z,q.w=A.distance,i.Cartesian4.multiplyByScalar(q,2/i.Cartesian4.dot(q,D),N),a[2]=N.x,a[6]=N.y,a[10]=N.z+1,a[14]=N.w}(this),this._offCenterFrustum.projectionMatrix}},infiniteProjectionMatrix:{get:function(){return I(this),this._offCenterFrustum.infiniteProjectionMatrix}},fovy:{get:function(){return I(this),this._fovy}},sseDenominator:{get:function(){return I(this),this._sseDenominator}}}),k.prototype.resetProjectionMatrix=function(){return this._offCenterFrustum.resetProjectionMatrix()},k.prototype.computeCullingVolume=function(t,e,a,i){return I(this),this._offCenterFrustum.computeCullingVolume(t,e,a,i)},k.prototype.getPixelDimensions=function(t,e,a,i,r){return I(this),this._offCenterFrustum.getPixelDimensions(t,e,a,i,r)},k.prototype.clone=function(t){return o.defined(t)||(t=new k),t.aspectRatio=this.aspectRatio,t.fov=this.fov,t.near=this.near,t.far=this.far,t.reflect=this.reflect,t.clipPlane=this.clipPlane,t.currentViewMatrix=this.currentViewMatrix,t._aspectRatio=void 0,t._fov=void 0,t._near=void 0,t._far=void 0,this._offCenterFrustum.clone(t._offCenterFrustum),t},k.prototype.equals=function(t){return!!(o.defined(t)&&t instanceof k)&&(I(this),I(t),this.fov===t.fov&&this.aspectRatio===t.aspectRatio&&this._offCenterFrustum.equals(t._offCenterFrustum))},k.prototype.equalsEpsilon=function(t,e,a){return!!(o.defined(t)&&t instanceof k)&&(I(this),I(t),l.CesiumMath.equalsEpsilon(this.fov,t.fov,e,a)&&l.CesiumMath.equalsEpsilon(this.aspectRatio,t.aspectRatio,e,a)&&this._offCenterFrustum.equalsEpsilon(t._offCenterFrustum,e,a))};var A=new p.Plane(a.Cartesian3.UNIT_Z,1),D=new i.Cartesian4,q=new i.Cartesian4,N=new i.Cartesian4;function B(t){var e,i,r=t.frustum,n=t.orientation,f=t.origin,u=o.defaultValue(t.vertexFormat,d.VertexFormat.DEFAULT),l=o.defaultValue(t._drawNearPlane,!0);r instanceof k?(e=0,i=k.packedLength):r instanceof F&&(e=1,i=F.packedLength),this._frustumType=e,this._frustum=r.clone(),this._origin=a.Cartesian3.clone(f),this._orientation=s.Quaternion.clone(n),this._drawNearPlane=l,this._vertexFormat=u,this._workerName="createFrustumGeometry",this.packedLength=2+i+a.Cartesian3.packedLength+s.Quaternion.packedLength+d.VertexFormat.packedLength}B.pack=function(t,e,i){i=o.defaultValue(i,0);var r=t._frustumType,n=t._frustum;return e[i++]=r,0===r?(k.pack(n,e,i),i+=k.packedLength):(F.pack(n,e,i),i+=F.packedLength),a.Cartesian3.pack(t._origin,e,i),i+=a.Cartesian3.packedLength,s.Quaternion.pack(t._orientation,e,i),i+=s.Quaternion.packedLength,d.VertexFormat.pack(t._vertexFormat,e,i),e[i+=d.VertexFormat.packedLength]=t._drawNearPlane?1:0,e};var L=new k,j=new F,G=new s.Quaternion,U=new a.Cartesian3,Q=new d.VertexFormat;function K(t,e,a,i,r,n,s,f){for(var u=t/3*2,l=0;l<4;++l)o.defined(e)&&(e[t]=n.x,e[t+1]=n.y,e[t+2]=n.z),o.defined(a)&&(a[t]=s.x,a[t+1]=s.y,a[t+2]=s.z),o.defined(i)&&(i[t]=f.x,i[t+1]=f.y,i[t+2]=f.z),t+=3;r[u]=0,r[u+1]=0,r[u+2]=1,r[u+3]=0,r[u+4]=1,r[u+5]=1,r[u+6]=0,r[u+7]=1}B.unpack=function(t,e,i){e=o.defaultValue(e,0);var r,n=t[e++];0===n?(r=k.unpack(t,e,L),e+=k.packedLength):(r=F.unpack(t,e,j),e+=F.packedLength);var f=a.Cartesian3.unpack(t,e,U);e+=a.Cartesian3.packedLength;var u=s.Quaternion.unpack(t,e,G);e+=s.Quaternion.packedLength;var l=d.VertexFormat.unpack(t,e,Q),h=1===t[e+=d.VertexFormat.packedLength];if(!o.defined(i))return new B({frustum:r,origin:f,orientation:u,vertexFormat:l,_drawNearPlane:h});var p=n===i._frustumType?i._frustum:void 0;return i._frustum=r.clone(p),i._frustumType=n,i._origin=a.Cartesian3.clone(f,i._origin),i._orientation=s.Quaternion.clone(u,i._orientation),i._vertexFormat=d.VertexFormat.clone(l,i._vertexFormat),i._drawNearPlane=h,i};var Y=new u.Matrix3,J=new u.Matrix4,Z=new u.Matrix4,H=new a.Cartesian3,W=new a.Cartesian3,X=new a.Cartesian3,$=new a.Cartesian3,tt=new a.Cartesian3,et=new a.Cartesian3,at=new Array(3),it=new Array(4);it[0]=new i.Cartesian4(-1,-1,1,1),it[1]=new i.Cartesian4(1,-1,1,1),it[2]=new i.Cartesian4(1,1,1,1),it[3]=new i.Cartesian4(-1,1,1,1);for(var rt=new Array(4),nt=0;nt<4;++nt)rt[nt]=new i.Cartesian4;B._computeNearFarPlanes=function(t,e,r,n,s,f,l,h){var p=u.Matrix3.fromQuaternion(e,Y),c=o.defaultValue(f,H),d=o.defaultValue(l,W),m=o.defaultValue(h,X);c=u.Matrix3.getColumn(p,0,c),d=u.Matrix3.getColumn(p,1,d),m=u.Matrix3.getColumn(p,2,m),a.Cartesian3.normalize(c,c),a.Cartesian3.normalize(d,d),a.Cartesian3.normalize(m,m),a.Cartesian3.negate(c,c);var C,_,y=u.Matrix4.computeView(t,m,d,c,J);if(0===r){var v=n.projectionMatrix,w=u.Matrix4.multiply(v,y,Z);_=u.Matrix4.inverse(w,Z)}else C=u.Matrix4.inverseTransformation(y,Z);o.defined(_)?(at[0]=n.near,at[1]=n.far):(at[0]=0,at[1]=n.near,at[2]=n.far);for(var g=0;g<2;++g)for(var x=0;x<4;++x){var M=i.Cartesian4.clone(it[x],rt[x]);if(o.defined(_)){var b=1/(M=u.Matrix4.multiplyByVector(_,M,M)).w;a.Cartesian3.multiplyByScalar(M,b,M),a.Cartesian3.subtract(M,t,M),a.Cartesian3.normalize(M,M);var V=a.Cartesian3.dot(m,M);a.Cartesian3.multiplyByScalar(M,at[g]/V,M),a.Cartesian3.add(M,t,M)}else{o.defined(n._offCenterFrustum)&&(n=n._offCenterFrustum);var F=at[g],P=at[g+1];M.x=.5*(M.x*(n.right-n.left)+n.left+n.right),M.y=.5*(M.y*(n.top-n.bottom)+n.bottom+n.top),M.z=.5*(M.z*(F-P)-F-P),M.w=1,u.Matrix4.multiplyByVector(C,M,M)}s[12*g+3*x]=M.x,s[12*g+3*x+1]=M.y,s[12*g+3*x+2]=M.z}},B.createGeometry=function(t){var i=t._frustumType,r=t._frustum,u=t._origin,l=t._orientation,h=t._drawNearPlane,p=t._vertexFormat,d=h?6:5,m=new Float64Array(72);B._computeNearFarPlanes(u,l,i,r,m);var C=24;m[C]=m[12],m[C+1]=m[13],m[C+2]=m[14],m[C+3]=m[0],m[C+4]=m[1],m[C+5]=m[2],m[C+6]=m[9],m[C+7]=m[10],m[C+8]=m[11],m[C+9]=m[21],m[C+10]=m[22],m[C+11]=m[23],m[C+=12]=m[15],m[C+1]=m[16],m[C+2]=m[17],m[C+3]=m[3],m[C+4]=m[4],m[C+5]=m[5],m[C+6]=m[0],m[C+7]=m[1],m[C+8]=m[2],m[C+9]=m[12],m[C+10]=m[13],m[C+11]=m[14],m[C+=12]=m[3],m[C+1]=m[4],m[C+2]=m[5],m[C+3]=m[15],m[C+4]=m[16],m[C+5]=m[17],m[C+6]=m[18],m[C+7]=m[19],m[C+8]=m[20],m[C+9]=m[6],m[C+10]=m[7],m[C+11]=m[8],m[C+=12]=m[6],m[C+1]=m[7],m[C+2]=m[8],m[C+3]=m[18],m[C+4]=m[19],m[C+5]=m[20],m[C+6]=m[21],m[C+7]=m[22],m[C+8]=m[23],m[C+9]=m[9],m[C+10]=m[10],m[C+11]=m[11],h||(m=m.subarray(12));var _=new f.GeometryAttributes({position:new s.GeometryAttribute({componentDatatype:n.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:m})});if(o.defined(p.normal)||o.defined(p.tangent)||o.defined(p.bitangent)||o.defined(p.st)){var y=o.defined(p.normal)?new Float32Array(12*d):void 0,v=o.defined(p.tangent)?new Float32Array(12*d):void 0,w=o.defined(p.bitangent)?new Float32Array(12*d):void 0,g=o.defined(p.st)?new Float32Array(8*d):void 0,x=H,M=W,b=X,V=a.Cartesian3.negate(x,$),F=a.Cartesian3.negate(M,tt),P=a.Cartesian3.negate(b,et);C=0,h&&(K(C,y,v,w,g,P,x,M),C+=12),K(C,y,v,w,g,b,V,M),K(C+=12,y,v,w,g,V,P,M),K(C+=12,y,v,w,g,F,P,V),K(C+=12,y,v,w,g,x,b,M),K(C+=12,y,v,w,g,M,b,V),o.defined(y)&&(_.normal=new s.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:y})),o.defined(v)&&(_.tangent=new s.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:v})),o.defined(w)&&(_.bitangent=new s.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:w})),o.defined(g)&&(_.st=new s.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:g}))}for(var E=new Uint16Array(6*d),O=0;O<d;++O){var z=6*O,R=4*O;E[z]=R,E[z+1]=R+1,E[z+2]=R+2,E[z+3]=R,E[z+4]=R+2,E[z+5]=R+3}return new s.Geometry({attributes:_,indices:E,primitiveType:c.PrimitiveType.TRIANGLES,boundingSphere:e.BoundingSphere.fromVertices(m)})},t.FrustumGeometry=B,t.OrthographicFrustum=F,t.PerspectiveFrustum=k}));
