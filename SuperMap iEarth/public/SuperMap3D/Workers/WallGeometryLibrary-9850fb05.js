define(["exports","./arrayRemoveDuplicates-30a3675e","./Cartographic-9ee1f1bd","./when-7d8885d2","./Math-4ffce144","./PolylinePipeline-f897b61d","./GeometryAttribute-84124076","./Matrix4-52faaaf8"],(function(e,i,t,r,n,a,o,l){"use strict";var s={};function h(e,i){return n.CesiumMath.equalsEpsilon(e.latitude,i.latitude,n.CesiumMath.EPSILON10)&&n.CesiumMath.equalsEpsilon(e.longitude,i.longitude,n.CesiumMath.EPSILON10)}var g=new t.Cartographic,p=new t.Cartographic;var d=new Array(2),u=new Array(2),y={positions:void 0,height:void 0,granularity:void 0,ellipsoid:void 0};function f(e,i){for(var r=new Array(e.length),n=0;n<e.length;n+=3){var a=new t.Cartesian3(e[n],e[n+1],e[n+2]);l.Matrix4.multiplyByPoint(i,a,a),r[n]=a.x,r[n+1]=a.y,r[n+2]=a.z}return r}s.computePositions=function(e,s,c,P,v,m,A){var w=function(e,n,a,o){var l=(n=i.arrayRemoveDuplicates(n,t.Cartesian3.equalsEpsilon)).length;if(!(l<2)){var s=r.defined(o),d=r.defined(a),u=!0,y=new Array(l),f=new Array(l),c=new Array(l),P=n[0];y[0]=P;var v=e.cartesianToCartographic(P,g);d&&(v.height=a[0]),u=u&&0==v.height,f[0]=v.height,c[0]=s?o[0]:0;for(var m=1,A=1;A<l;++A){var w=n[A],C=e.cartesianToCartographic(w,p);d&&(C.height=a[A]),u=u&&0==C.height,h(v,C)?v.height<C.height&&(f[m-1]=C.height):(y[m]=w,f[m]=C.height,c[m]=s?o[A]:0,t.Cartographic.clone(C,v),++m)}if(!(u||m<2))return y.length=m,f.length=m,c.length=m,{positions:y,topHeights:f,bottomHeights:c}}}(e,s,c,P);if(r.defined(w)){var C=o.Transforms.eastNorthUpToFixedFrame(w.positions[0],e,new l.Matrix4),M=l.Matrix4.inverse(C,new l.Matrix4);s=w.positions,c=w.topHeights,P=w.bottomHeights;var F,b,x,E,H=s.length,L=H-2,T=n.CesiumMath.chordLength(v,e.maximumRadius),q=y;if(q.minDistance=T,q.ellipsoid=e,m){var D,N=0;for(D=0;D<H-1;D++)N+=a.PolylinePipeline.numberOfPoints(s[D],s[D+1],T)+1;F=new Float64Array(3*N),b=new Float64Array(3*N),r.defined(A)&&(x=new Float64Array(3*N),E=new Float64Array(3*N));var O=d,R=u;q.positions=O,q.height=R;var G=0;for(D=0;D<H-1;D++){O[0]=s[D],O[1]=s[D+1],R[0]=c[D],R[1]=c[D+1];var I=a.PolylinePipeline.generateArc(q);F.set(I,G),r.defined(A)&&x.set(f(I,M),G),R[0]=P[D],R[1]=P[D+1],b.set(a.PolylinePipeline.generateArc(q),G),r.defined(A)&&E.set(f(a.PolylinePipeline.generateArc(q),M),G),G+=I.length}}else q.positions=s,q.height=c,F=new Float64Array(a.PolylinePipeline.generateArc(q)),r.defined(A)&&(x=new Float64Array(f(a.PolylinePipeline.generateArc(q)))),q.height=P,b=new Float64Array(a.PolylinePipeline.generateArc(q)),r.defined(A)&&(E=new Float64Array(f(a.PolylinePipeline.generateArc(q))));var S={pos:{bottomPositions:b,topPositions:F,numCorners:L}};return r.defined(A)&&(S.localPos={bottomPositions:E,topPositions:x,numCorners:L}),S}},e.WallGeometryLibrary=s}));
