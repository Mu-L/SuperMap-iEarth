define(["exports","./buildModuleUrl-91a0d359","./Cartesian2-54f49cd5","./Cartographic-9ee1f1bd","./Cartesian4-6d2e270a","./Check-737bd4ec","./when-7d8885d2","./EllipsoidTangentPlane-3d01b139","./Intersect-3d22ecf4","./Math-4ffce144","./Matrix4-52faaaf8","./Plane-b5076158","./PolygonPipeline-d3f0dbfd"],(function(a,t,e,n,r,i,s,o,C,d,u,c,l){"use strict";var h=[];function m(a,t){this.center=n.Cartesian3.clone(s.defaultValue(a,n.Cartesian3.ZERO)),this.halfAxes=u.Matrix3.clone(s.defaultValue(t,u.Matrix3.ZERO)),this.areaDirty=1}h[0]={num:0,des:"inside"},h[1]={num:4,data:[0,4,7,3],des:"left"},h[2]={num:4,data:[1,2,6,5],des:"right"},h[3]={num:0},h[4]={num:4,data:[0,1,5,4],des:"bottom"},h[5]={num:6,data:[0,1,5,4,7,3],des:"bottom, left"},h[6]={num:6,data:[0,1,2,6,5,4],des:"bottom, right"},h[7]={num:0},h[8]={num:4,data:[2,3,7,6],des:"top"},h[9]={num:6,data:[4,7,6,2,3,0],des:"top, left"},h[10]={num:6,data:[2,3,7,6,5,1],des:"top, right"},h[11]={num:0},h[12]={num:0},h[13]={num:0},h[14]={num:0},h[15]={num:0},h[16]={num:4,data:[0,3,2,1],des:"front"},h[17]={num:6,data:[0,4,7,3,2,1],des:"front, left"},h[18]={num:6,data:[0,3,2,6,5,1],des:"front, right"},h[19]={num:0},h[20]={num:6,data:[0,3,2,1,5,4],des:"front, bottom"},h[21]={num:6,data:[2,1,5,4,7,3],des:"front, bottom, left"},h[22]={num:6,data:[0,3,2,6,5,4],des:"front, bottom, right"},h[23]={num:0},h[24]={num:6,data:[0,3,7,6,2,1],des:"front, top"},h[25]={num:6,data:[0,4,7,6,2,1],des:"front, top, left"},h[26]={num:6,data:[0,3,7,6,5,1],des:"front, top, right"},h[27]={num:0},h[28]={num:0},h[29]={num:0},h[30]={num:0},h[31]={num:0},h[32]={num:4,data:[4,5,6,7],des:"back"},h[33]={num:6,data:[4,5,6,7,3,0],des:"back, left"},h[34]={num:6,data:[1,2,6,7,4,5],des:"back, right"},h[35]={num:0},h[36]={num:6,data:[0,1,5,6,7,4],des:"back, bottom"},h[37]={num:6,data:[0,1,5,6,7,3],des:"back, bottom, left"},h[38]={num:6,data:[0,1,2,6,7,4],des:"back, bottom, right"},h[39]={num:0},h[40]={num:6,data:[2,3,7,4,5,6],des:"back, top"},h[41]={num:6,data:[0,4,5,6,2,3],des:"back, top, left"},h[42]={num:6,data:[1,2,3,7,4,5],des:"back, top, right"},m.packedLength=n.Cartesian3.packedLength+u.Matrix3.packedLength,m.pack=function(a,t,e){return e=s.defaultValue(e,0),n.Cartesian3.pack(a.center,t,e),u.Matrix3.pack(a.halfAxes,t,e+n.Cartesian3.packedLength),t},m.unpack=function(a,t,e){return t=s.defaultValue(t,0),s.defined(e)||(e=new m),n.Cartesian3.unpack(a,t,e.center),u.Matrix3.unpack(a,t+n.Cartesian3.packedLength,e.halfAxes),e};var x=new n.Cartesian3,f=new n.Cartesian3,p=new n.Cartesian3,M=new n.Cartesian3,g=new n.Cartesian3,w=new n.Cartesian3,b=new u.Matrix3,y={unitary:new u.Matrix3,diagonal:new u.Matrix3},v=new n.Cartesian3,P=new n.Cartesian3,O=new n.Cartesian3;m.fromPoints=function(a,t){if(s.defined(t)||(t=new m),!s.defined(a)||0===a.length)return t.halfAxes=u.Matrix3.ZERO,t.center=n.Cartesian3.ZERO,t;var e,r=a.length,i=n.Cartesian3.clone(a[0],x);for(e=1;e<r;e++)n.Cartesian3.add(i,a[e],i);var o=1/r;n.Cartesian3.multiplyByScalar(i,o,i);var C,d=0,c=0,l=0,h=0,v=0,P=0;for(e=0;e<r;e++)d+=(C=n.Cartesian3.subtract(a[e],i,f)).x*C.x,c+=C.x*C.y,l+=C.x*C.z,h+=C.y*C.y,v+=C.y*C.z,P+=C.z*C.z;d*=o,c*=o,l*=o,h*=o,v*=o,P*=o;var O=b;O[0]=d,O[1]=c,O[2]=l,O[3]=c,O[4]=h,O[5]=v,O[6]=l,O[7]=v,O[8]=P;var z=u.Matrix3.computeEigenDecomposition(O,y),A=u.Matrix3.clone(z.unitary,t.halfAxes),N=u.Matrix3.getColumn(A,0,M),I=u.Matrix3.getColumn(A,1,g),R=u.Matrix3.getColumn(A,2,w),T=-Number.MAX_VALUE,E=-Number.MAX_VALUE,B=-Number.MAX_VALUE,L=Number.MAX_VALUE,k=Number.MAX_VALUE,U=Number.MAX_VALUE;for(e=0;e<r;e++)C=a[e],T=Math.max(n.Cartesian3.dot(N,C),T),E=Math.max(n.Cartesian3.dot(I,C),E),B=Math.max(n.Cartesian3.dot(R,C),B),L=Math.min(n.Cartesian3.dot(N,C),L),k=Math.min(n.Cartesian3.dot(I,C),k),U=Math.min(n.Cartesian3.dot(R,C),U);N=n.Cartesian3.multiplyByScalar(N,.5*(L+T),N),I=n.Cartesian3.multiplyByScalar(I,.5*(k+E),I),R=n.Cartesian3.multiplyByScalar(R,.5*(U+B),R);var V=n.Cartesian3.add(N,I,t.center);n.Cartesian3.add(V,R,V);var S=p;return S.x=T-L,S.y=E-k,S.z=B-U,n.Cartesian3.multiplyByScalar(S,.5,S),u.Matrix3.multiplyByScale(t.halfAxes,S,t.halfAxes),t};var z=new n.Cartesian3,A=new n.Cartesian3;function N(a,t,e,r,i,o,C,d,c,l,h){s.defined(h)||(h=new m);var x=h.halfAxes;u.Matrix3.setColumn(x,0,t,x),u.Matrix3.setColumn(x,1,e,x),u.Matrix3.setColumn(x,2,r,x);var f=z;f.x=(i+o)/2,f.y=(C+d)/2,f.z=(c+l)/2;var p=A;p.x=(o-i)/2,p.y=(d-C)/2,p.z=(l-c)/2;var M=h.center;return f=u.Matrix3.multiplyByVector(x,f,f),n.Cartesian3.add(a,f,M),u.Matrix3.multiplyByScale(x,p,x),h}var I=new n.Cartographic,R=new n.Cartesian3,T=new n.Cartographic,E=new n.Cartographic,B=new n.Cartographic,L=new n.Cartographic,k=new n.Cartographic,U=new n.Cartesian3,V=new n.Cartesian3,S=new n.Cartesian3,_=new n.Cartesian3,D=new n.Cartesian3,X=new e.Cartesian2,W=new e.Cartesian2,q=new e.Cartesian2,j=new e.Cartesian2,Z=new e.Cartesian2,F=new n.Cartesian3,G=new n.Cartesian3,Y=new n.Cartesian3,H=new n.Cartesian3,J=new e.Cartesian2,K=new n.Cartesian3,Q=new n.Cartesian3,$=new n.Cartesian3,aa=new c.Plane(n.Cartesian3.UNIT_X,0);m.fromRectangle=function(a,t,r,i,C){var u,l,h,m,x,f,p;if(t=s.defaultValue(t,0),r=s.defaultValue(r,0),i=s.defaultValue(i,e.Ellipsoid.WGS84),a.width<=d.CesiumMath.PI){var M=e.Rectangle.center(a,I),g=i.cartographicToCartesian(M,R),w=new o.EllipsoidTangentPlane(g,i);p=w.plane;var b=M.longitude,y=a.south<0&&a.north>0?0:M.latitude,v=n.Cartographic.fromRadians(b,a.north,r,T),P=n.Cartographic.fromRadians(a.west,a.north,r,E),O=n.Cartographic.fromRadians(a.west,y,r,B),z=n.Cartographic.fromRadians(a.west,a.south,r,L),A=n.Cartographic.fromRadians(b,a.south,r,k),ta=i.cartographicToCartesian(v,U),ea=i.cartographicToCartesian(P,V),na=i.cartographicToCartesian(O,S),ra=i.cartographicToCartesian(z,_),ia=i.cartographicToCartesian(A,D),sa=w.projectPointToNearestOnPlane(ta,X),oa=w.projectPointToNearestOnPlane(ea,W),Ca=w.projectPointToNearestOnPlane(na,q),da=w.projectPointToNearestOnPlane(ra,j),ua=w.projectPointToNearestOnPlane(ia,Z);return l=-(u=Math.min(oa.x,Ca.x,da.x)),m=Math.max(oa.y,sa.y),h=Math.min(da.y,ua.y),P.height=z.height=t,ea=i.cartographicToCartesian(P,V),ra=i.cartographicToCartesian(z,_),x=Math.min(c.Plane.getPointDistance(p,ea),c.Plane.getPointDistance(p,ra)),f=r,N(w.origin,w.xAxis,w.yAxis,w.zAxis,u,l,h,m,x,f,C)}var ca=a.south>0,la=a.north<0,ha=ca?a.south:la?a.north:0,ma=e.Rectangle.center(a,I).longitude,xa=n.Cartesian3.fromRadians(ma,ha,r,i,F);xa.z=0;var fa=Math.abs(xa.x)<d.CesiumMath.EPSILON10&&Math.abs(xa.y)<d.CesiumMath.EPSILON10?n.Cartesian3.UNIT_X:n.Cartesian3.normalize(xa,G),pa=n.Cartesian3.UNIT_Z,Ma=n.Cartesian3.cross(fa,pa,Y);p=c.Plane.fromPointNormal(xa,fa,aa);var ga=n.Cartesian3.fromRadians(ma+d.CesiumMath.PI_OVER_TWO,ha,r,i,H);u=-(l=n.Cartesian3.dot(c.Plane.projectPointOntoPlane(p,ga,J),Ma)),m=n.Cartesian3.fromRadians(0,a.north,la?t:r,i,K).z,h=n.Cartesian3.fromRadians(0,a.south,ca?t:r,i,Q).z;var wa=n.Cartesian3.fromRadians(a.east,ha,r,i,$);return N(xa,Ma,pa,fa,u,l,h,m,x=c.Plane.getPointDistance(p,wa),f=0,C)},m.clone=function(a,t){if(s.defined(a))return s.defined(t)?(n.Cartesian3.clone(a.center,t.center),u.Matrix3.clone(a.halfAxes,t.halfAxes),t.areaDirty=1,t):new m(a.center,a.halfAxes)},m.intersectPlane=function(a,t){var e=a.center,r=t.normal,i=a.halfAxes,s=r.x,o=r.y,d=r.z,c=Math.abs(s*i[u.Matrix3.COLUMN0ROW0]+o*i[u.Matrix3.COLUMN0ROW1]+d*i[u.Matrix3.COLUMN0ROW2])+Math.abs(s*i[u.Matrix3.COLUMN1ROW0]+o*i[u.Matrix3.COLUMN1ROW1]+d*i[u.Matrix3.COLUMN1ROW2])+Math.abs(s*i[u.Matrix3.COLUMN2ROW0]+o*i[u.Matrix3.COLUMN2ROW1]+d*i[u.Matrix3.COLUMN2ROW2]),l=n.Cartesian3.dot(r,e)+t.distance;return l<=-c?C.Intersect.OUTSIDE:l>=c?C.Intersect.INSIDE:C.Intersect.INTERSECTING};var ta=new n.Cartesian3,ea=new n.Cartesian3,na=new n.Cartesian3,ra=new n.Cartesian3,ia=new n.Cartesian3;m.distanceSquaredTo=function(a,t){var e=n.Cartesian3.subtract(t,a.center,z),r=a.halfAxes,i=u.Matrix3.getColumn(r,0,ta),s=u.Matrix3.getColumn(r,1,ea),o=u.Matrix3.getColumn(r,2,na),C=n.Cartesian3.magnitude(i),d=n.Cartesian3.magnitude(s),c=n.Cartesian3.magnitude(o);n.Cartesian3.normalize(i,i),n.Cartesian3.normalize(s,s),n.Cartesian3.normalize(o,o);var l=ra;l.x=n.Cartesian3.dot(e,i),l.y=n.Cartesian3.dot(e,s),l.z=n.Cartesian3.dot(e,o);var h,m=0;return l.x<-C?m+=(h=l.x+C)*h:l.x>C&&(m+=(h=l.x-C)*h),l.y<-d?m+=(h=l.y+d)*h:l.y>d&&(m+=(h=l.y-d)*h),l.z<-c?m+=(h=l.z+c)*h:l.z>c&&(m+=(h=l.z-c)*h),m};var sa=new n.Cartesian3,oa=new n.Cartesian3;m.computePlaneDistances=function(a,e,r,i){s.defined(i)||(i=new t.Interval);var o=Number.POSITIVE_INFINITY,C=Number.NEGATIVE_INFINITY,d=a.center,c=a.halfAxes,l=u.Matrix3.getColumn(c,0,ta),h=u.Matrix3.getColumn(c,1,ea),m=u.Matrix3.getColumn(c,2,na),x=n.Cartesian3.add(l,h,sa);n.Cartesian3.add(x,m,x),n.Cartesian3.add(x,d,x);var f=n.Cartesian3.subtract(x,e,oa),p=n.Cartesian3.dot(r,f);return o=Math.min(p,o),C=Math.max(p,C),n.Cartesian3.add(d,l,x),n.Cartesian3.add(x,h,x),n.Cartesian3.subtract(x,m,x),n.Cartesian3.subtract(x,e,f),p=n.Cartesian3.dot(r,f),o=Math.min(p,o),C=Math.max(p,C),n.Cartesian3.add(d,l,x),n.Cartesian3.subtract(x,h,x),n.Cartesian3.add(x,m,x),n.Cartesian3.subtract(x,e,f),p=n.Cartesian3.dot(r,f),o=Math.min(p,o),C=Math.max(p,C),n.Cartesian3.add(d,l,x),n.Cartesian3.subtract(x,h,x),n.Cartesian3.subtract(x,m,x),n.Cartesian3.subtract(x,e,f),p=n.Cartesian3.dot(r,f),o=Math.min(p,o),C=Math.max(p,C),n.Cartesian3.subtract(d,l,x),n.Cartesian3.add(x,h,x),n.Cartesian3.add(x,m,x),n.Cartesian3.subtract(x,e,f),p=n.Cartesian3.dot(r,f),o=Math.min(p,o),C=Math.max(p,C),n.Cartesian3.subtract(d,l,x),n.Cartesian3.add(x,h,x),n.Cartesian3.subtract(x,m,x),n.Cartesian3.subtract(x,e,f),p=n.Cartesian3.dot(r,f),o=Math.min(p,o),C=Math.max(p,C),n.Cartesian3.subtract(d,l,x),n.Cartesian3.subtract(x,h,x),n.Cartesian3.add(x,m,x),n.Cartesian3.subtract(x,e,f),p=n.Cartesian3.dot(r,f),o=Math.min(p,o),C=Math.max(p,C),n.Cartesian3.subtract(d,l,x),n.Cartesian3.subtract(x,h,x),n.Cartesian3.subtract(x,m,x),n.Cartesian3.subtract(x,e,f),p=n.Cartesian3.dot(r,f),o=Math.min(p,o),C=Math.max(p,C),i.start=o,i.stop=C,i};var Ca=new t.BoundingSphere;m.isOccluded=function(a,e){var n=t.BoundingSphere.fromOrientedBoundingBox(a,Ca);return!e.isBoundingSphereVisible(n)},m.prototype.intersectPlane=function(a){return m.intersectPlane(this,a)},m.prototype.distanceSquaredTo=function(a){return m.distanceSquaredTo(this,a)},m.prototype.computePlaneDistances=function(a,t,e){return m.computePlaneDistances(this,a,t,e)},m.prototype.isOccluded=function(a){return m.isOccluded(this,a)},m.equals=function(a,t){return a===t||s.defined(a)&&s.defined(t)&&n.Cartesian3.equals(a.center,t.center)&&u.Matrix3.equals(a.halfAxes,t.halfAxes)},m.prototype.clone=function(a){return m.clone(this,a)},m.prototype.equals=function(a){return m.equals(this,a)};var da=new r.Cartesian4;m.prototype._updateBBox=function(){if(1==this.areaDirty){var a=u.Matrix3.getColumn(this.halfAxes,0,ta),t=n.Cartesian3.clone(n.Cartesian3.negate(a,v)),e=u.Matrix3.getColumn(this.halfAxes,1,ea),r=n.Cartesian3.clone(n.Cartesian3.negate(e,v)),i=u.Matrix3.getColumn(this.halfAxes,2,na),s=n.Cartesian3.clone(n.Cartesian3.negate(i,v));this.bbox=[],n.Cartesian3.add(this.center,e,v),n.Cartesian3.add(v,s,P),n.Cartesian3.add(P,t,O),this.bbox[0]=new n.Cartesian3(O.x,O.y,O.z),n.Cartesian3.add(P,a,O),this.bbox[1]=new n.Cartesian3(O.x,O.y,O.z),n.Cartesian3.add(v,i,P),n.Cartesian3.add(P,a,O),this.bbox[2]=new n.Cartesian3(O.x,O.y,O.z),n.Cartesian3.add(P,t,O),this.bbox[3]=new n.Cartesian3(O.x,O.y,O.z),n.Cartesian3.add(this.center,r,v),n.Cartesian3.add(v,s,P),n.Cartesian3.add(P,t,O),this.bbox[4]=new n.Cartesian3(O.x,O.y,O.z),n.Cartesian3.add(P,a,O),this.bbox[5]=new n.Cartesian3(O.x,O.y,O.z),n.Cartesian3.add(v,i,P),n.Cartesian3.add(P,a,O),this.bbox[6]=new n.Cartesian3(O.x,O.y,O.z),n.Cartesian3.add(P,t,O),this.bbox[7]=new n.Cartesian3(O.x,O.y,O.z);var o=n.Cartesian3.magnitude(a),C=n.Cartesian3.magnitude(e),d=n.Cartesian3.magnitude(i),c=new n.Cartesian3(-o,-C,-d),l=new n.Cartesian3(o,C,d);if(o*C*d==0)return void(this.areaDirty=-1);n.Cartesian3.normalize(a,a),n.Cartesian3.normalize(e,e),n.Cartesian3.normalize(i,i),this.u=n.Cartesian3.clone(a),this.v=n.Cartesian3.clone(e),this.w=n.Cartesian3.clone(i),this.posMin=c,this.posMaX=l,this.areaDirty=0}};var ua=[];ua.push(new e.Cartesian2),ua.push(new e.Cartesian2),ua.push(new e.Cartesian2),ua.push(new e.Cartesian2),ua.push(new e.Cartesian2),ua.push(new e.Cartesian2);var ca=new n.Cartographic,la=new n.Cartesian3;m.prototype.calculateBoxArea=function(a,t,e,i,o,C,c,m){this._updateBBox();var x=a,f=n.Cartesian3.subtract(x,this.center,ia);if(-1==this.areaDirty){var p=o/i*(N=-1!=C?C:.5*n.Cartesian3.distance(this.posMaX,this.posMin))/e;return d.CesiumMath.PI*p*p}var M=n.Cartesian3.fromElements(n.Cartesian3.dot(f,this.u),n.Cartesian3.dot(f,this.v),n.Cartesian3.dot(f,this.w),sa),g=(M.x<this.posMin.x?1:0)+((M.x>this.posMaX.x?1:0)<<1)+((M.z<this.posMin.z?1:0)<<2)+((M.z>this.posMaX.z?1:0)<<3)+((M.y>this.posMaX.y?1:0)<<4)+((M.y<this.posMin.y?1:0)<<5);if(g>42)return console.log("area calculation is wrong"),-100;var w=h[g];if(0==w.num){p=o/i*(N=-1!=C?C:.5*n.Cartesian3.distance(this.posMaX,this.posMin))/e;return d.CesiumMath.PI*p*p}if(0==w.num)return console.log("area calculation is wrong"),-100;for(var b,y=[],v=c,P=0;P<w.num;P++){var O,z=ua[P],A=this.bbox[w.data[P]];b=!1;var N,I=d.CesiumMath.PI;if(3===t)(O=u.Matrix4.multiplyByVector(v,r.Cartesian4.fromElements(A.x,A.y,A.z,1),da)).z<0&&(b=!0,-1==N&&(I=d.CesiumMath.PI_OVER_FOUR,e=n.Cartesian3.magnitude(f)));else{var R=m,T=R.ellipsoid.cartesianToCartographic(A,ca);s.defined(T)?(R.project(T,la),(O=u.Matrix4.multiplyByVector(v,r.Cartesian4.fromElements(la.z,la.x,la.y,1),da)).z<0&&(b=!0)):b=!0}if(1==b)return I*(p=o/i*(N=-1!=C?C:.5*n.Cartesian3.distance(this.posMaX,this.posMin))/e)*p;z.x=O.x/O.w,z.y=o-O.y/O.w,y.push(z)}return Math.abs(l.PolygonPipeline.computeArea2D(y))},a.OrientedBoundingBox=m}));
